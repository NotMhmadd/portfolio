// =============================================
// PORTFOLIO DATA - All projects with their images (Alphabetically sorted)
// =============================================

const projects = [
    {
        id: 'avene',
        name: 'Avène',
        type: 'Skincare & Product Design',
        thumbnail: 'images/optimized/avene/cleanser-png.jpg',
        images: [
            'images/optimized/avene/cleanser-png.jpg',
            'images/optimized/avene/anti-blemishes--anti-marks--smoothed-skin-texture-png.jpg',
            'images/optimized/avene/carefully-selected-ingredients-png.jpg',
            'images/optimized/avene/comedomed-png.jpg',
            'images/optimized/avene/comedomed-2-png.jpg',
            'images/optimized/avene/for-oily---acne-prone-skin--png.jpg',
            'images/optimized/avene/hydra-png.jpg'
        ]
    },
    {
        id: 'cannelle',
        name: 'Cannelle',
        type: 'Product Photography',
        thumbnail: 'images/optimized/cannelle/c-23-phase-one34865-jpg.jpg',
        images: [
            'images/optimized/cannelle/c-23-phase-one34865-jpg.jpg',
            'images/optimized/cannelle/c-23-phase-one34869-jpg.jpg',
            'images/optimized/cannelle/c-23-phase-one34871-jpg.jpg',
            'images/optimized/cannelle/c-23-phase-one34873-jpg.jpg',
            'images/optimized/cannelle/c-23-phase-one34875-jpg.jpg',
            'images/optimized/cannelle/c-23-phase-one34876-jpg.jpg',
            'images/optimized/cannelle/p0034701-jpg.jpg',
            'images/optimized/cannelle/p0034713-jpg.jpg'
        ]
    },
    {
        id: 'ethos',
        name: 'Ethos',
        type: 'Agency Branding',
        thumbnail: 'images/optimized/ethos/hiring--digital-account-lead-jpg.jpg',
        images: [
            'images/optimized/ethos/hiring--digital-account-lead-jpg.jpg'
        ]
    },
    {
        id: 'freshdays',
        name: 'Freshdays',
        type: 'Social Media & Video',
        thumbnail: 'images/optimized/freshdays/fresh-life-png.jpg',
        images: [
            'images/optimized/freshdays/fresh-life-png.jpg',
            'images/optimized/freshdays/autumn-favs-png.jpg',
            'images/optimized/freshdays/freshdays-2-colored-png.jpg',
            'images/optimized/freshdays/freshdays-girls-1-png.jpg',
            'images/optimized/freshdays/freshdays-girls-2-png.jpg',
            'images/optimized/freshdays/freshdays-girls-3-png.jpg',
            'images/optimized/freshdays/freshdays-padel-png.jpg',
            'images/optimized/freshdays/freshdays-snow-png.jpg',
            'images/optimized/freshdays/self-care-routine-png.jpg',
            'images/optimized/freshdays/when-to-use-png.jpg'
        ],
        videos: [
            'images/Freshdays/20250925Folder Freshdays.mp4',
            'images/Freshdays/20251006 Freshdays Slot Machine.mp4',
            'images/Freshdays/Harvesting Freshness Final.mp4'
        ]
    },
    {
        id: 'gipsy',
        name: 'Gipsy',
        type: 'Restaurant Branding',
        thumbnail: 'images/optimized/gipsy/meshwar-ma3-el-3ayle-starter-pack-1-png.jpg',
        images: [
            'images/optimized/gipsy/meshwar-ma3-el-3ayle-starter-pack-1-png.jpg',
            'images/optimized/gipsy/meshwar-ma3-el-3ayle-starter-pack-2-png.jpg',
            'images/optimized/gipsy/meshwar-ma3-el-3ayle-starter-pack-3-png.jpg',
            'images/optimized/gipsy/meshwar-ma3-el-3ayle-starter-pack-4-png.jpg',
            'images/optimized/gipsy/new-album-dropped-by-gipsy-1-png.jpg',
            'images/optimized/gipsy/new-album-dropped-by-gipsy-2-png.jpg',
            'images/optimized/gipsy/new-album-dropped-by-gipsy-3-png.jpg',
            'images/optimized/gipsy/new-album-dropped-by-gipsy-4-png.jpg'
        ],
        videos: [
            'images/Gipsy/Final Gipsy AI Reel.MOV'
        ]
    },
    {
        id: 'handy',
        name: 'Handy',
        type: 'Product Marketing',
        thumbnail: 'images/optimized/handy/bterba7-png.jpg',
        images: [
            'images/optimized/handy/bterba7-png.jpg',
            'images/optimized/handy/awareness-post-static--3arous-png.jpg',
            'images/optimized/handy/beautifully-cooked-salmon-fillet-png.jpg',
            'images/optimized/handy/event-post-carousel-lovers-png.jpg',
            'images/optimized/handy/handy-christmas-tree-products-png.jpg',
            'images/optimized/handy/sanita-handy-uplift-2-0-03-jpg.jpg'
        ],
        videos: [
            'images/Handy/20251226 Handy Christmas Final.mp4'
        ]
    },
    {
        id: 'happies',
        name: 'Happies',
        type: 'Video Production',
        thumbnail: 'images/optimized/freshdays/fresh-life-png.jpg', // Placeholder
        videos: [
            'images/Happies/20251208 Happies AI Reel.mp4',
            'images/Happies/Final Happies AI Video.mp4',
            'images/Happies/Happies Reel - with you from the beginning.mp4'
        ]
    },
    {
        id: 'mccafe',
        name: 'McCafé',
        type: 'Social Media Campaign',
        thumbnail: 'images/optimized/hero/mccafe.jpg',
        images: [
            'images/optimized/mccafe/1-mccafe-founding-day-theme-4-posts-jpg.jpg',
            'images/optimized/mccafe/2-mccafe-founding-day-theme-4-posts-jpg.jpg',
            'images/optimized/mccafe/3-mccafe-founding-day-theme-4-posts-jpg.jpg',
            'images/optimized/mccafe/4-mccafe-founding-day-theme-4-posts-jpg.jpg',
            'images/optimized/mccafe/april-fools-day-jpg.jpg',
            'images/optimized/mccafe/art-day-jpg.jpg',
            'images/optimized/mccafe/comic-jpg.jpg',
            'images/optimized/mccafe/conceptual-post-jpg.jpg',
            'images/optimized/mccafe/conceptual-post-2-jpg.jpg',
            'images/optimized/mccafe/creative-touch-march-jpg.jpg',
            'images/optimized/mccafe/creative-touch-may-jpg.jpg',
            'images/optimized/mccafe/cup-illustration-v1-jpg.jpg',
            'images/optimized/mccafe/cup-illustration-v1-2-jpg.jpg',
            'images/optimized/mccafe/jamisne-cup-jpg.jpg',
            'images/optimized/mccafe/mr--conceptual-jpg.jpg',
            'images/optimized/mccafe/new-location-jpg.jpg',
            'images/optimized/mccafe/smiling-cookie-jpg.jpg',
            'images/optimized/mccafe/snow-mccafe---feb-2023-jpg.jpg',
            'images/optimized/mccafe/summer-1-jpg.jpg',
            'images/optimized/mccafe/summer-2-jpg.jpg',
            'images/optimized/mccafe/summer-3-jpg.jpg',
            'images/optimized/mccafe/world-autism-day-jpg.jpg',
            'images/optimized/mccafe/world-earth-day-jpg.jpg',
            'images/optimized/mccafe/world-happiness-day-jpg.jpg'
        ]
    },
    {
        id: 'mcdo',
        name: "McDonald's",
        type: 'Social Media',
        thumbnail: 'images/optimized/mcdo/----------------------jpg.jpg',
        images: [
            'images/optimized/mcdo/----------------------jpg.jpg',
            'images/optimized/mcdo/--------------------jpg.jpg'
        ]
    },
    {
        id: 'oppo',
        name: 'OPPO',
        type: 'Tech & Product',
        thumbnail: 'images/optimized/hero/oppo.jpg',
        images: [
            'images/optimized/oppo/oppo-world-book-day-png.jpg',
            'images/optimized/oppo/world-burger-day-png.jpg'
        ],
        videos: [
            'images/OPPO/20251027 OPPO Earbuds charging.mp4',
            'images/OPPO/20260105 OPPO 1.mp4',
            'images/OPPO/Final Reel Fajr to Fajr OPPO.mp4'
        ]
    },
    {
        id: 'popeyes',
        name: 'Popeyes',
        type: 'Food & Campaign',
        thumbnail: 'images/optimized/popeyes/2-popeyes-images-grid-jpg.jpg',
        images: [
            'images/optimized/popeyes/2-popeyes-images-grid-jpg.jpg',
            'images/optimized/popeyes/4-popeyes-images-grid-jpg.jpg',
            'images/optimized/popeyes/popeyes-images-grid-1-jpg.jpg',
            'images/optimized/popeyes/popeyes-snd-grid-jpg.jpg',
            'images/optimized/popeyes/popeyes-snd-jpg.jpg',
            'images/optimized/popeyes/2-year-popeyes-offer-png.jpg',
            'images/optimized/popeyes/2-year-popeyes-offer-1-png.jpg'
        ]
    },
    {
        id: 'private',
        name: '3D & Personal',
        type: '3D Design',
        thumbnail: 'images/optimized/private/vending-machine-png.jpg',
        images: [
            'images/optimized/private/vending-machine-png.jpg',
            'images/optimized/private/-1-1---------------png.jpg',
            'images/optimized/private/-----------png.jpg'
        ]
    },
    {
        id: 'sifr',
        name: 'Al Sifr Magazine',
        type: 'Editorial Design',
        thumbnail: 'images/optimized/sifr/website-share-jpg.jpg',
        images: [
            'images/optimized/sifr/website-share-jpg.jpg',
            'images/optimized/sifr/zero-graph-jpg.jpg',
            'images/optimized/sifr/zero-graph-2-jpg.jpg',
            'images/optimized/sifr/fgard7pxkaaocnd-jpeg.jpg',
            'images/optimized/sifr/fh2dpgywqaas2j1-jpeg.jpg',
            'images/optimized/sifr/fhdffoawqaqxpwz-jpeg.jpg',
            'images/optimized/sifr/fi0gkisxoaizfgv-jpeg.jpg',
            'images/optimized/sifr/fi5nskkxeaig9pc-jpeg.jpg'
        ]
    },
    {
        id: 'sofar',
        name: 'Sofar Sounds',
        type: 'Event Branding',
        thumbnail: 'images/optimized/sofar/july-29th-jpg.jpg',
        images: [
            'images/optimized/sofar/july-29th-jpg.jpg',
            'images/optimized/sofar/sofar-september-9-jpg.jpg'
        ]
    }
];

// =============================================
// DOM ELEMENTS
// =============================================
const gallery = document.getElementById('gallery');
const searchBar = document.getElementById('searchBar');
const filterBar = document.querySelector('.filter-bar');
const modal = document.getElementById('projectModal');
const modalTitle = document.querySelector('.modal-title');
const modalCategory = document.querySelector('.modal-category');
const modalGallery = document.querySelector('.modal-gallery');
const modalClose = document.querySelector('.modal-close');
const modalBackdrop = document.querySelector('.modal-backdrop');

// =============================================
// STATE
// =============================================
let currentSearch = '';

// =============================================
// RENDER PROJECT CARDS
// =============================================
function renderProjects() {
    gallery.innerHTML = '';
    
    const filtered = projects.filter(project => {
        const searchTerm = currentSearch.toLowerCase();
        return project.name.toLowerCase().includes(searchTerm) || 
               project.type.toLowerCase().includes(searchTerm);
    });

    if (filtered.length === 0) {
        gallery.innerHTML = `
            <div style="grid-column: 1/-1; text-align: center; padding: 4rem 2rem; color: #6B7280;">
                <i class="fas fa-search" style="font-size: 2.5rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                <p>No projects found matching "${currentSearch}"</p>
            </div>
        `;
        return;
    }

    filtered.forEach((project, index) => {
        const imageCount = (project.images?.length || 0) + (project.videos?.length || 0);
        const card = document.createElement('div');
        card.className = 'project-card';
        card.style.animationDelay = `${index * 0.05}s`;
        
        card.innerHTML = `
            <div class="project-thumbnail">
                <img src="${project.thumbnail}" alt="${project.name}" loading="lazy" onerror="this.style.display='none'">
                ${imageCount > 1 ? `<span class="project-count">${imageCount} items</span>` : ''}
            </div>
            <div class="project-info">
                <h3 class="project-name">${project.name}</h3>
                <p class="project-type">${project.type}</p>
            </div>
        `;
        
        card.addEventListener('click', () => openModal(project));
        gallery.appendChild(card);
    });
}

// =============================================
// MODAL
// =============================================

// Create lightbox for full image view
const lightbox = document.createElement('div');
lightbox.className = 'image-lightbox';
lightbox.innerHTML = `
    <button class="lightbox-close"><i class="fas fa-times"></i></button>
    <img src="" alt="Full view">
`;
document.body.appendChild(lightbox);

const lightboxImg = lightbox.querySelector('img');
const lightboxClose = lightbox.querySelector('.lightbox-close');

function openLightbox(src) {
    lightboxImg.src = src;
    lightbox.classList.add('active');
}

function closeLightbox() {
    lightbox.classList.remove('active');
    lightboxImg.src = '';
}

lightboxClose.addEventListener('click', closeLightbox);
lightbox.addEventListener('click', (e) => {
    if (e.target === lightbox) closeLightbox();
});

function openModal(project) {
    modalTitle.textContent = project.name;
    modalCategory.textContent = project.type;
    modalGallery.innerHTML = '';
    
    // Add images with staggered animation
    if (project.images) {
        project.images.forEach((src, index) => {
            const item = document.createElement('div');
            item.className = 'gallery-item';
            item.style.animationDelay = `${index * 0.05}s`;
            
            const img = document.createElement('img');
            img.src = src;
            img.alt = project.name;
            img.loading = 'lazy';
            img.onerror = function() { this.parentElement.style.display = 'none'; };
            
            item.appendChild(img);
            item.addEventListener('click', () => openLightbox(src));
            modalGallery.appendChild(item);
        });
    }
    
    // Add videos
    if (project.videos) {
        project.videos.forEach((src, index) => {
            const item = document.createElement('div');
            item.className = 'gallery-item video-item';
            item.style.animationDelay = `${(project.images?.length || 0 + index) * 0.05}s`;
            
            const video = document.createElement('video');
            video.src = src;
            video.controls = true;
            video.preload = 'metadata';
            video.poster = project.images?.[0] || '';
            
            item.appendChild(video);
            modalGallery.appendChild(item);
        });
    }
    
    modal.classList.remove('hidden');
    document.body.style.overflow = 'hidden';
}

function closeModal() {
    modal.classList.add('hidden');
    document.body.style.overflow = 'auto';
    // Pause all videos
    modalGallery.querySelectorAll('video').forEach(v => v.pause());
    closeLightbox();
}

// =============================================
// EVENT LISTENERS
// =============================================
searchBar.addEventListener('input', (e) => {
    currentSearch = e.target.value;
    renderProjects();
});

modalClose.addEventListener('click', closeModal);
modalBackdrop.addEventListener('click', closeModal);

document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
        if (lightbox.classList.contains('active')) {
            closeLightbox();
        } else {
            closeModal();
        }
    }
});

// Smooth scroll for anchor links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function(e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            target.scrollIntoView({ behavior: 'smooth' });
        }
    });
});

// Navbar hide/show on scroll
const nav = document.querySelector('.floating-nav');
let lastScroll = 0;
let ticking = false;

window.addEventListener('scroll', () => {
    if (!ticking) {
        window.requestAnimationFrame(() => {
            const currentScroll = window.pageYOffset;
            
            if (currentScroll > lastScroll && currentScroll > 300) {
                nav.style.transform = 'translateX(-50%) translateY(-100px)';
            } else {
                nav.style.transform = 'translateX(-50%) translateY(0)';
            }
            
            lastScroll = currentScroll;
            ticking = false;
        });
        ticking = true;
    }
});

// =============================================
// INIT
// =============================================
renderProjects();

// Intersection Observer for section animations
const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
};

const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.style.opacity = '1';
            entry.target.style.transform = 'translateY(0)';
        }
    });
}, observerOptions);

document.querySelectorAll('.about-section, .contact-section').forEach(section => {
    section.style.opacity = '0';
    section.style.transform = 'translateY(30px)';
    section.style.transition = 'all 0.6s ease';
    observer.observe(section);
});

// Subtle parallax on hero bento grid
const heroBento = document.querySelector('.hero-bento');
if (heroBento) {
    document.addEventListener('mousemove', (e) => {
        if (window.innerWidth > 1024) {
            const x = (e.clientX - window.innerWidth / 2) / 80;
            const y = (e.clientY - window.innerHeight / 2) / 80;
            
            const bentoItems = heroBento.querySelectorAll('.bento-item');
            bentoItems.forEach((item, index) => {
                const factor = (index + 1) * 0.3;
                item.style.transform = `translate(${x * factor}px, ${y * factor}px)`;
            });
            
            const badges = document.querySelectorAll('.hero-badge');
            badges.forEach((badge, index) => {
                const factor = index === 0 ? -1.5 : 1.5;
                badge.style.transform = `translate(${x * factor}px, ${y * factor}px)`;
            });
        }
    });
}
